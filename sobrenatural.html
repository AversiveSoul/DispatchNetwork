<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>????</title>
    <link href="https://fonts.googleapis.com/css2?family=Special+Elite&family=Cutive+Mono&display=swap" rel="stylesheet">
    
    <script>
        // Verificação de autenticação original
        (function() {
            const isAuthenticated = sessionStorage.getItem('sdn_auth');
            if (isAuthenticated !== 'true') {
                window.location.href = "index.html";
            }
        })();
    </script>
 <script>
    (function() {
        // Verifica se o dispositivo é mobile baseado no User Agent ou largura da tela
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) 
                         || (window.innerWidth <= 800);

        if (isMobile) {
            window.location.href = "no-mobile.html";
        }
    })();
</script>
    <style>
        :root {
            --bg-color: #050505;
            --paper-color: #0d0d0d;
            --text-color: #a0a0a0;
            --danger-high: #ff0000;
            --danger-med: #8b0000;
            --danger-low: #b18c00;
            --safe-green: #00ff41;
        }

        body {
            background-color: var(--bg-color);
            background-image: 
                linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), 
                linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 4px, 3px 100%;
            color: var(--text-color);
            font-family: 'Special Elite', typewriter, serif;
            margin: 0;
            padding: 40px 20px;
            overflow: hidden; /* Travado durante o script */
        }

        /* --- OVERLAY DO SCRIPT DE ENTRADA --- */
        #entry-script {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #000;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 1s ease;
        }

        .user-portrait {
            width: 250px;
            height: 320px;
            border: 2px solid #333;
            background-size: cover;
            background-position: center;
            margin-bottom: 20px;
        }

        /* Efeito Creepy */
        .effect-creepy {
            filter: grayscale(1) contrast(3) brightness(0.6) sepia(1) hue-rotate(-50deg);
            animation: glitch-anim 0.2s infinite;
            border-color: var(--danger-high);
            box-shadow: 0 0 20px var(--danger-high);
        }

        /* Efeito Constantino (Normal) */
        .effect-normal {
            border-color: var(--safe-green);
            box-shadow: 0 0 20px var(--safe-green);
        }

        .msg-text { font-size: 1.8rem; text-align: center; max-width: 80%; }
        .text-red { color: var(--danger-high); text-shadow: 0 0 10px red; }
        .text-green { color: var(--safe-green); text-shadow: 0 0 10px green; }

        @keyframes glitch-anim {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); filter: invert(0.1) contrast(5); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }

        /* --- ESTILOS ORIGINAIS --- */
        body::after {
            content: "";
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://www.transparenttextures.com/patterns/stardust.png');
            opacity: 0.05;
            pointer-events: none;
            z-index: 100;
        }

        .vignette {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, transparent 20%, black 120%);
            pointer-events: none;
            z-index: 10;
        }

        .btn-back {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 15px;
            background: transparent;
            border: 1px solid #333;
            color: #444;
            text-decoration: none;
            font-size: 0.7rem;
            z-index: 50;
            transition: 0.3s;
        }

        #lista-sobrenatural {
            max-width: 1000px;
            margin: 0 auto;
            position: relative;
            z-index: 5;
            display: none; /* Escondido até o fim do script */
        }

        .card {
            background: var(--paper-color);
            border: 1px solid #1a1a1a;
            margin-bottom: 100px;
            padding: 40px;
            position: relative;
            box-shadow: 0 0 50px rgba(0,0,0,0.9);
        }

        .card-header { margin-bottom: 30px; border-bottom: 1px solid #222; padding-bottom: 10px; }
        .titulo-container h2 { margin: 0; font-size: 2.5rem; color: #eee; text-shadow: 3px 3px 0px #300; }
        .categoria-tag { font-family: 'Cutive Mono', monospace; background: #4a0404; color: #fff; padding: 2px 8px; font-size: 0.8rem; }
        .perigo-box { position: absolute; top: 40px; right: 40px; padding: 15px; border: 3px double; transform: rotate(5deg); }
        .perigo-valor { font-size: 2rem; display: block; font-weight: bold; }
        .perigo-label { font-size: 0.6rem; text-transform: uppercase; letter-spacing: 2px; }
        .conteudo-flex { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; align-items: start; }
        .portrait-frame { border: 1px solid #333; background: #000; padding: 5px; position: relative; }
        .portrait-frame img { width: 100%; filter: grayscale(1) contrast(1.5) brightness(0.8); transition: 0.5s; }
        .info-texto { font-size: 1rem; color: #888; border-left: 1px solid #222; padding-left: 30px; }
        .acidente-img { margin-top: 30px; width: 100%; filter: grayscale(1) sepia(0.5) blur(1px); opacity: 0.4; border: 1px solid #222; }
        .perigo-extremo { color: var(--danger-high); border-color: var(--danger-high); animation: pulse-red 1s infinite alternate; }

        @keyframes pulse-red {
            from { box-shadow: 0 0 5px #f00; text-shadow: 0 0 5px #f00; }
            to { box-shadow: 0 0 20px #f00; text-shadow: 0 0 20px #f00; }
        }
    </style>
</head>
<body>

    <audio id="bgMusic" loop>
        <source src="musica2.mp3" type="audio/mpeg">
    </audio>

    <div id="entry-script">
        <div id="script-portrait" class="user-portrait"></div>
        <div id="script-message" class="msg-text"></div>
    </div>

    <div class="vignette"></div>

    <a href="welcomeback.html" class="btn-back">Voltar</a>

    <main id="lista-sobrenatural"></main>

    <script>
        const usuariosDB = [
            { "heroName": "Super Estrelado", "portraitFilename": "SuperEstrelado.jpg" },
            { "heroName": "Constantino", "portraitFilename": "Constantino.jpg" },
            { "heroName": "Severin", "portraitFilename": "Severin.jpg" },
            { "heroName": "Compliance", "portraitFilename": "Compliance.jpg" },
            { "heroName": "Á Jato", "portraitFilename": "Ajato.jpg" }
        ];

        const nomeUsuarioLogado = sessionStorage.getItem('active_user') || "Super Estrelado";
        const usuarioAtivo = usuariosDB.find(u => u.heroName === nomeUsuarioLogado) || usuariosDB[0];

        function iniciarTerminal() {
            const overlay = document.getElementById('entry-script');
            const portrait = document.getElementById('script-portrait');
            const message = document.getElementById('script-message');
            const main = document.getElementById('lista-sobrenatural');
            const music = document.getElementById('bgMusic');

            // Toca a musica2.mp3
            if(music) {
                music.volume = 0.2;
                music.play().catch(e => console.log("Áudio aguardando interação ou erro de carregamento."));
            }

            portrait.style.backgroundImage = `url('FotosDosAgentes/${usuarioAtivo.portraitFilename}')`;

            if (nomeUsuarioLogado === "Constantino") {
                message.innerHTML = "Seja muito bem vindo, Constantino.";
                message.className = "msg-text text-green";
                portrait.className = "user-portrait effect-normal";
            } else {
                message.innerHTML = `Você não deveria estar aqui, ${nomeUsuarioLogado}.`;
                message.className = "msg-text text-red";
                portrait.className = "user-portrait effect-creepy";
            }

            setTimeout(() => {
                overlay.style.opacity = "0";
                setTimeout(() => {
                    overlay.style.display = "none";
                    main.style.display = "block";
                    document.body.style.overflow = "auto";
                }, 1000);
            }, 4000);
        }

        const container = document.getElementById('lista-sobrenatural');

        fetch('sobrenatural.json')
            .then(response => response.json())
            .then(data => {
                data.forEach(item => {
                    const card = document.createElement('div');
                    const eNome = (item.entidade && item.entidade.trim() !== "") ? item.entidade : item.evento;
                    const eTipo = (item.entidade && item.entidade.trim() !== "") ? "CLASSIFICAÇÃO: ENTIDADE" : "CLASSIFICAÇÃO: EVENTO";
                    
                    let perigoClasse = item.nivelDePerigo >= 71 ? "perigo-extremo" : (item.nivelDePerigo >= 51 ? "perigo-alto" : "perigo-medio");

                    card.className = `card`;
                    card.innerHTML = `
                        <div class="perigo-box ${perigoClasse}">
                            <span class="perigo-label">Nível de Ameaça</span>
                            <span class="perigo-valor">${item.nivelDePerigo}%</span>
                        </div>
                        <div class="card-header">
                            <span class="categoria-tag">${eTipo}</span>
                            <div class="titulo-container"><h2>${eNome}</h2></div>
                        </div>
                        <div class="conteudo-flex">
                            <div class="portrait-frame">
                                <img src="SobrenaturalFotos/${item.portraitFilename}" alt="DATA_MISSING">
                            </div>
                            <div class="info-texto">
                                <strong>> INFORMAÇÕES_OBTIDAS:</strong>
                                <p>${item.InformacaoConhecida}</p>
                                <div style="margin-top:40px">
                                    <small style="letter-spacing:3px; color:#444">EVIDÊNCIA_VISUAL_01</small>
                                    <img class="acidente-img" src="SobrenaturalFotos/${item.imagemAcidente}" alt="EVIDENCIA">
                                </div>
                            </div>
                        </div>
                    `;
                    container.appendChild(card);
                });
                
                iniciarTerminal();
            })
            .catch(error => {
                console.error('ERRO CRÍTICO');
                iniciarTerminal();
            });
    </script>
</body>
</html>